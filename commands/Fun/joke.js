const axios = require('axios');
const { getLang } = require('../../lib/lang');

const jokes_ar = [
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø±Ø§Ø­ Ù„Ù„Ø¯ÙƒØªÙˆØ± Ù‚Ø§Ù„Ù‡ Ø¹Ù†Ø¯ÙŠ ØµØ¯Ø§Ø¹.. Ù‚Ø§Ù„Ù‡ Ø±ÙˆØ­ Ù†Ø§Ù… ğŸ˜´",
  "Ù…Ø±Ø© Ù…Ø¯Ø±Ø³ Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø®Ù„Ù ÙˆÙ„Ø¯ Ø³Ù…Ø§Ù‡ Ø¬Ø°Ø± ğŸ˜­",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ØºØ¨ÙŠ Ø§Ø´ØªØ±Ù‰ Ù…Ø±ÙˆØ­Ø© Ù‚Ø¹Ø¯ ÙŠØ·ÙÙŠÙ‡Ø§ Ù„Ù…Ø§ ÙŠØ¨Ø±Ø¯ ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø±Ø§Ø­ ÙŠØ´ØªØºÙ„ ÙÙŠ Ø§Ù„Ø³ÙŠØ±Ùƒ Ø·Ù„Ø¹ Ù…ÙØµÙˆÙ„ Ø¹Ø´Ø§Ù† Ø¨ÙŠØ¶Ø­Ùƒ Ù„ÙˆØ­Ø¯Ù‡ ğŸ¤¡",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ÙØªØ­ Ù…Ø­Ù„ Ø¹ØµÙŠØ± Ø³Ù…Ø§Ù‡ ÙƒØ¯Ù‡ ÙˆØ®Ù„Ø§Øµ ğŸ§ƒ",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø³Ø£Ù„ ØµØ§Ø­Ø¨Ù‡: Ø§Ù„Ø³Ø§Ø¹Ø© ÙƒØ§Ù…ØŸ Ù‚Ø§Ù„Ù‡ Ø§Ù„Ø²Ù…Ù† ØºØ¯Ø§Ø± ğŸ˜”",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ø³Ø±ÙŠØ± Ù…Ø±ÙŠØ­ Ù†Ø§Ù… Ø¬Ù†Ø¨Ù‡ ğŸ˜´",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø­Ø¨ ÙŠÙ†Ø¬Ø­â€¦ Ø±Ø§Ø­ Ù†Ø§Ù… ğŸ›Œ",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§ØªØ®Ø§Ù†Ù‚ Ù…Ø¹ Ù†ÙØ³Ù‡ ÙˆØ§ØªØµØ§Ù„Ø­ÙˆØ§ Ø¨Ø§Ù„Ø¹Ø§ÙÙŠØ© ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¨ÙŠØ°Ø§ÙƒØ± ØªØ§Ø±ÙŠØ® Ù„Ù‚Ù‰ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…Ø¬Ù‡ÙˆÙ„ ğŸ¤¯",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ØºØ¨ÙŠ ÙØªØ­ Ø§Ù„Ø´Ø¨Ø§Ùƒ ÙŠØ´ÙˆÙ Ø§Ù„Ù†Øª Ø¬Ø§ÙŠ ÙˆÙ„Ø§ Ù„Ø£ ğŸ“¶ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ ÙƒØªØ§Ø¨ Ø¹Ù† Ø§Ù„ÙƒØ³Ù„â€¦ Ù…Ø§ Ù‚Ø±Ù‡ÙˆØ´ ğŸ˜´",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ©â€¦ Ù„Ø³Ù‡ Ø¨ÙŠØ³Ø£Ù„ Ø¹Ù† Ø§Ù„ÙˆÙ‚Øª âŒšğŸ¤¦â€â™‚ï¸",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ÙƒØªØ¨ Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ³: Ø²Ù‡Ù‚Ø§Ù†â€¦ Ø§Ù„ÙÙŠØ³ Ø²Ù‡Ù‚ Ù…Ø¹Ø§Ù‡ ğŸ˜­",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¯Ø®Ù„ Ø§Ù…ØªØ­Ø§Ù† Ù…ØªØ£Ø®Ø±â€¦ Ø³Ù„Ù… Ø¨Ø¯Ø±ÙŠ ğŸ˜…",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø´Ø§Ù Ù†ÙØ³Ù‡ ÙÙŠ Ø§Ù„Ù…Ø±Ø§ÙŠØ© Ù‚Ø§Ù„: Ù„Ø§ Ø­ÙˆÙ„ ÙˆÙ„Ø§ Ù‚ÙˆØ© Ø¥Ù„Ø§ Ø¨Ø§Ù„Ù„Ù‡ ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø³Ø£Ù„ Ø§Ù„ØªØ§Ù†ÙŠ: Ø¨ØªØ­Ø¨ Ø§Ù„Ø´Ø§ÙŠØŸ Ù‚Ø§Ù„Ù‡ Ø¢Ù‡ Ø¨Ø³ Ù…Ù† ØºÙŠØ± Ø´Ø§ÙŠ â˜•ğŸ¤¡",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¨ÙŠØ¬Ø±ÙŠ ÙˆØ±Ø§ Ø£Ø­Ù„Ø§Ù…Ù‡â€¦ ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø±ÙŠØ± ğŸ›Œ",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ØºØ¨ÙŠ Ø±ÙƒØ¨ GPS Ø¶Ø§Ø¹ ğŸ˜­",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ø³Ù…Ø§Ø¹Ø© Ø¨Ù„ÙˆØªÙˆØ«â€¦ Ø¨ÙŠØ³Ù…Ø¹ Ø§Ù„Ø¬ÙŠØ±Ø§Ù† ğŸ§ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¯Ø®Ù„ Ø³ÙŠÙ†Ù…Ø§ Ù…ØªØ£Ø®Ø±â€¦ Ø´Ø§Ù Ø§Ù„ØªÙŠØªØ±Ø§Øª ğŸ¤¦â€â™‚ï¸",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¨ÙŠÙ‚ÙˆÙ„ Ù„ØµØ§Ø­Ø¨Ù‡: Ø£Ù†Ø§ Ø¯Ù…Ø§ØºÙŠ ÙØ§Ø¶ÙŠØ©ØŒ Ù‚Ø§Ù„Ù‡ Ù†Ø¸ÙÙ‡Ø§ ğŸ§ ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ù†Ø§Ù… ÙÙŠ Ø§Ù„Ø´ØºÙ„â€¦ ØµØ­Ù‰ Ù…Ø·Ø±ÙˆØ¯ ğŸ˜­",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ ØªÙ„ÙŠÙÙˆÙ† Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ù…ÙŠØ©â€¦ Ø¹Ø·Ø´Ø§Ù† ğŸ“±ğŸ’§",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¨ÙŠÙÙƒØ± ÙƒØªÙŠØ±â€¦ ØµØ¯Ø¹ Ù…Ù† Ø§Ù„ØªÙÙƒÙŠØ± ğŸ¤¯",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø³Ø£Ù„ Ø¯ÙƒØªÙˆØ±: Ø¹Ù†Ø¯ÙŠ Ø£Ø±Ù‚ØŒ Ù‚Ø§Ù„Ù‡ Ù†Ø§Ù… ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¯Ø®Ù„ Ù…Ø·Ø¹Ù… Ù‚Ø§Ù„Ù‡Ù… Ø¹Ù†Ø¯ÙƒÙ… Ø£ÙƒÙ„ØŸ Ù‚Ø§Ù„ÙˆØ§ Ø¢Ù‡â€¦ Ø®Ø±Ø¬ ğŸ˜…",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¨ÙŠØ­Ø¨ Ø§Ù„ØµØ±Ø§Ø­Ø©â€¦ Ø²Ø¹Ù„ Ù…Ù† Ù†ÙØ³Ù‡ ğŸ¤¡",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ù…Ø±Ø§ÙŠØ©â€¦ Ø±Ø¬Ø¹Ù‡Ø§ Ø¹Ø´Ø§Ù† Ù…Ø´ Ø´Ø¨Ù‡Ù‡ ğŸ˜­",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ÙØªØ­ Ù…Ø®Ù‡â€¦ Ù„Ù‚Ù‰ Ù„Ø§ Ø´ÙŠØ¡ ğŸš«ğŸ§ ",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø±Ø§Ø­ Ø§Ù„Ø¬ÙŠÙ…â€¦ ØªØ¹Ø¨ Ù…Ù† Ø§Ù„Ø³Ø®ÙˆÙ†ÙŠØ© ÙˆÙ…Ø´ÙŠ ğŸ‹ï¸â€â™‚ï¸ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ø¬Ø²Ù…Ø© Ø±ÙŠØ§Ø¶ÙŠØ©â€¦ Ù‚Ø¹Ø¯ ÙŠØªÙØ±Ø¬ Ø¹Ù„ÙŠÙ‡Ø§ ğŸ‘Ÿ",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¨ÙŠØ°Ø§ÙƒØ± Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø¨Ø³Ù†Ø©â€¦ Ù†Ø§Ù… ğŸ’¤",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ù…Ø®Ø¯Ø© Ù…Ø±ÙŠØ­Ø©â€¦ ØµØ­Ù‰ ØªØ¹Ø¨Ø§Ù† ğŸ˜­",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø¯Ø®Ù„ ÙƒØ§ÙÙŠÙ‡ Ù‚Ø§Ù„Ù‡Ù… Ø¹Ù†Ø¯ÙƒÙ… ÙˆØ§ÙŠ ÙØ§ÙŠØŸ Ù‚Ø§Ù„ÙˆØ§ Ø¢Ù‡â€¦ Ù‚Ø¹Ø¯ Ø³Ø§ÙƒØª ğŸ“¶",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ ØºØ¨ÙŠ ÙØªØ­ Ø§Ù„ØªÙ„Ø§Ø¬Ø© ÙŠØ´ÙˆÙ Ø§Ù„Ø¯Ù†ÙŠØ§ Ø­Ø± ÙˆÙ„Ø§ Ù„Ø£ â„ï¸ğŸ˜‚",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø§Ø´ØªØ±Ù‰ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø¬Ø¯ÙŠØ¯â€¦ Ù†Ø³ÙŠ Ø±Ù‚Ù…Ù‡ ğŸ¤¦â€â™‚ï¸",
  "Ù…Ø±Ø© ÙˆØ§Ø­Ø¯ Ø±Ø§Ø­ ÙŠØµÙ„Ù‘Ø­ Ø¯Ù…Ø§ØºÙ‡â€¦ Ù‚Ø§Ù„ÙˆÙ„Ù‡ Ù…ÙÙŠØ´ Ù‚Ø·Ø¹ ØºÙŠØ§Ø± ğŸ§ ğŸ˜‚"
];

async function jokeCommand(sock, message) {
  const chatId = message.key.remoteJid;
  const lang = getLang(chatId);

  try {
    await sock.sendMessage(chatId, {
      react: { text: 'ğŸ˜‚', key: message.key }
    }).catch(() => {});

    if (lang === 'ar') {
      const joke = jokes_ar[Math.floor(Math.random() * jokes_ar.length)];
      await sock.sendMessage(chatId, { text: joke }, { quoted: message });

      await sock.sendMessage(chatId, {
        react: { text: 'âœ…', key: message.key }
      }).catch(() => {});
      return;
    }

    const response = await axios.get('https://icanhazdadjoke.com/', {
      headers: { Accept: 'application/json' },
      timeout: 15000
    });

    const joke = response.data?.joke;
    if (!joke) throw new Error('No joke');

    await sock.sendMessage(chatId, { text: joke }, { quoted: message });

    await sock.sendMessage(chatId, {
      react: { text: 'âœ…', key: message.key }
    }).catch(() => {});

  } catch (err) {
    console.error('[JOKE]', err);

    await sock.sendMessage(chatId, {
      react: { text: 'âŒ', key: message.key }
    }).catch(() => {});

    await sock.sendMessage(
      chatId,
      {
        text:
          lang === 'ar'
            ? 'ğŸ˜“ Ø­ØµÙ„ Ø®Ø·Ø£ ÙˆØ£Ù†Ø§ Ø¨Ø­Ø§ÙˆÙ„ Ø£Ø¶Ø­ÙƒÙƒ'
            : 'ğŸ˜“ Failed to fetch a joke right now'
      },
      { quoted: message }
    );
  }
}

module.exports = {
  name: 'joke',
  aliases: ['joke', 'Ù†ÙƒØªØ©', 'Ù†ÙƒØª'],
  category: {
    ar: 'ğŸ¯ Ø£ÙˆØ§Ù…Ø± Ø§Ù„ØªØ±ÙÙŠÙ‡',
    en: 'ğŸ¯ Fun Commands'
  },
  emoji: 'ğŸ˜‚',
  admin: false,
  owner: false,
  showInMenu: true,
  exec: jokeCommand,
  run: jokeCommand,
  execute: jokeCommand
};